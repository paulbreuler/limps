# Regenerate skills manifest if skills or related files changed
if git diff --cached --name-only | grep -Eq '(^|/)\.claude/skills/|^scripts/generate-skills-manifest\.js$|^skills(-limps)?\.yaml$'; then
  cd "$(git rev-parse --show-toplevel)"
  npm run skills:manifest
  git add skills.yaml skills-limps.yaml
fi

# Run validation from root (format, lint, type-check, build across workspaces).
# Tests are intentionally skipped to avoid flaky pre-commit failures.
cd "$(git rev-parse --show-toplevel)" && npm run format && git add -u && npm run lint && npm run type-check && npm run build
